{"ast":null,"code":"import _objectSpread from\"C:/Repo/GitHub/rubiks-cube/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useMemo,useCallback,useEffect}from'react';import{Canvas,useFrame}from'@react-three/fiber';import{OrbitControls,Environment}from'@react-three/drei';import*as THREE from'three';// Custom logging function that will be visible in terminal\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const logToTerminal=function(message){let data=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;// Log to browser console\nconsole.log(\"\\n\\uD83C\\uDFAF \".concat(message));if(data){console.log(JSON.stringify(data,null,2));}console.log('='.repeat(80)+'\\n');// Send to log server to print in terminal\nfetch('http://localhost:3001/log',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:message,data:data})}).then(response=>{if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}console.log('âœ… Log sent to terminal successfully');}).catch(error=>{console.error('âŒ Could not send log to terminal server:',error);console.log('ðŸ’¡ Make sure the log server is running with: npm run log-server');});};// Function to create unique shapes for each piece\nfunction createShape(pieceId,size){const shapes=[// 0-4: Basic geometric shapes (Squares)\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"red\"})]}),// Square\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"blue\"})]}),// Square\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"green\"})]}),// Square\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"orange\"})]}),// Square\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"purple\"})]}),// Square\n// 5-9: Circles\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"circleGeometry\",{args:[size/2,32]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"red\"})]}),// Circle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"circleGeometry\",{args:[size/2,32]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"blue\"})]}),// Circle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"circleGeometry\",{args:[size/2,32]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"green\"})]}),// Circle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"circleGeometry\",{args:[size/2,32]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"orange\"})]}),// Circle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"circleGeometry\",{args:[size/2,32]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"purple\"})]}),// Circle\n// 10-14: Triangles (using planeGeometry for now, ideally custom geometry)\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"red\"})]}),// Triangle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"blue\"})]}),// Triangle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"green\"})]}),// Triangle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"orange\"})]}),// Triangle\n()=>/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"purple\"})]}),// Triangle\n// 15-19: Diamonds (rotated squares)\n()=>/*#__PURE__*/_jsx(\"group\",{position:[0,0,0.012],children:/*#__PURE__*/_jsxs(\"mesh\",{rotation:[0,0,Math.PI/4],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"red\"})]})}),// Diamond\n()=>/*#__PURE__*/_jsx(\"group\",{position:[0,0,0.012],children:/*#__PURE__*/_jsxs(\"mesh\",{rotation:[0,0,Math.PI/4],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"blue\"})]})}),// Diamond\n()=>/*#__PURE__*/_jsx(\"group\",{position:[0,0,0.012],children:/*#__PURE__*/_jsxs(\"mesh\",{rotation:[0,0,Math.PI/4],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"green\"})]})}),// Diamond\n()=>/*#__PURE__*/_jsx(\"group\",{position:[0,0,0.012],children:/*#__PURE__*/_jsxs(\"mesh\",{rotation:[0,0,Math.PI/4],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"orange\"})]})}),// Diamond\n()=>/*#__PURE__*/_jsx(\"group\",{position:[0,0,0.012],children:/*#__PURE__*/_jsxs(\"mesh\",{rotation:[0,0,Math.PI/4],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"purple\"})]})}),// Diamond\n// 20-25: Complex patterns (Squares with white centers)\n()=>/*#__PURE__*/_jsxs(\"group\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsxs(\"mesh\",{children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"red\"})]}),/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.001],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size*0.5,size*0.5]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"white\"})]})]}),// Square with white center\n()=>/*#__PURE__*/_jsxs(\"group\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsxs(\"mesh\",{children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"blue\"})]}),/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.001],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size*0.5,size*0.5]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"white\"})]})]}),// Square with white center\n()=>/*#__PURE__*/_jsxs(\"group\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsxs(\"mesh\",{children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"green\"})]}),/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.001],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size*0.5,size*0.5]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"white\"})]})]}),// Square with white center\n()=>/*#__PURE__*/_jsxs(\"group\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsxs(\"mesh\",{children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"orange\"})]}),/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.001],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size*0.5,size*0.5]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"white\"})]})]}),// Square with white center\n()=>/*#__PURE__*/_jsxs(\"group\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsxs(\"mesh\",{children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"purple\"})]}),/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.001],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size*0.5,size*0.5]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"white\"})]})]}),// Square with white center\n()=>/*#__PURE__*/_jsxs(\"group\",{position:[0,0,0.012],children:[/*#__PURE__*/_jsxs(\"mesh\",{children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size,size]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"cyan\"})]}),/*#__PURE__*/_jsxs(\"mesh\",{position:[0,0,0.001],children:[/*#__PURE__*/_jsx(\"planeGeometry\",{args:[size*0.5,size*0.5]}),/*#__PURE__*/_jsx(\"meshBasicMaterial\",{color:\"white\"})]})]})// Square with white center\n];const shapeIndex=pieceId;// Changed from pieceId % shapes.length\nreturn shapes[shapeIndex]();}// Individual cube piece component\nfunction CubePiece(_ref){let{position,colors,size=0.95,pieceId=0}=_ref;const meshRef=useRef();// Log piece information for debugging\nReact.useEffect(()=>{const shapeTypes=['Square','Square','Square','Square','Square','Circle','Circle','Circle','Circle','Circle','Triangle','Triangle','Triangle','Triangle','Triangle','Diamond','Diamond','Diamond','Diamond','Diamond','Square+White','Square+White','Square+White','Square+White','Square+White','Square+White'];const shapeColors=['Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Cyan'];const shapeType=shapeTypes[pieceId]||'Unknown';// Changed from pieceId % shapeTypes.length\nconst shapeColor=shapeColors[pieceId]||'Unknown';// Changed from pieceId % shapeColors.length\n// Debug specific pieces only\nif(pieceId===0||pieceId===17||pieceId===25||pieceId===1||pieceId===11){console.log(\"\\uD83D\\uDD0D \".concat(shapeColor,\" \").concat(shapeType,\" Piece \").concat(pieceId,\" at position [\").concat(position.join(', '),\"]\"));console.log(\"  Stored Colors:\",colors);// Show what colors should be visible based on position\nconst[x,y,z]=position;const visibleFaces=[];if(x===1)visibleFaces.push('right');if(x===-1)visibleFaces.push('left');if(y===1)visibleFaces.push('top');if(y===-1)visibleFaces.push('bottom');if(z===1)visibleFaces.push('front');if(z===-1)visibleFaces.push('back');console.log(\"  Visible faces:\",visibleFaces);console.log(\"  Colors on visible faces:\",visibleFaces.map(face=>\"\".concat(face,\": \").concat(colors[face])));}},[pieceId,position,colors]);// Color mapping\nconst colorMap={'white':'#FFFFFF','yellow':'#FFD700','red':'#FF0000','orange':'#FFA500','blue':'#0000FF','green':'#00FF00','black':'#000000'};// Create cube geometry\nconst cubeGeometry=useMemo(()=>new THREE.BoxGeometry(size,size,size),[size]);// Create face geometry\nconst faceGeometry=useMemo(()=>{const geometry=new THREE.PlaneGeometry(size,size);return geometry;},[size]);// Get the color for a face based on the face index and position\nconst getFaceColor=faceIndex=>{const[x,y,z]=position;// Determine which faces are visible based on position\nconst visibleFaces=[];if(x===1)visibleFaces.push(2);// Right face visible\nif(x===-1)visibleFaces.push(3);// Left face visible\nif(y===1)visibleFaces.push(4);// Top face visible\nif(y===-1)visibleFaces.push(5);// Bottom face visible\nif(z===1)visibleFaces.push(0);// Front face visible\nif(z===-1)visibleFaces.push(1);// Back face visible\n// Map face index to color property\nlet faceColor;switch(faceIndex){case 0:faceColor=colors.front;break;// Front face\ncase 1:faceColor=colors.back;break;// Back face\ncase 2:faceColor=colors.right;break;// Right face\ncase 3:faceColor=colors.left;break;// Left face\ncase 4:faceColor=colors.top;break;// Top face\ncase 5:faceColor=colors.bottom;break;// Bottom face\ndefault:faceColor='black';}// If this face is not visible, return black\nif(!visibleFaces.includes(faceIndex)){return'black';}// Debug logging for specific pieces\nif(pieceId===2||pieceId===11||pieceId===16||pieceId===19||pieceId===22||pieceId===25){const faceNames=['front','back','right','left','top','bottom'];console.log(\"\\uD83C\\uDFA8 Piece \".concat(pieceId,\" face \").concat(faceNames[faceIndex],\" (\").concat(faceIndex,\") at [\").concat(x,\",\").concat(y,\",\").concat(z,\"]: \").concat(faceColor,\" (visible: \").concat(visibleFaces.includes(faceIndex),\")\"));}return faceColor;};return/*#__PURE__*/_jsxs(\"group\",{position:position,children:[/*#__PURE__*/_jsx(\"mesh\",{geometry:cubeGeometry,children:/*#__PURE__*/_jsx(\"meshPhongMaterial\",{color:\"#333333\"})}),[0,1,2,3,4,5].map(faceIndex=>{const faceColor=getFaceColor(faceIndex);// Define face positions and rotations correctly\nlet facePosition,faceRotation;switch(faceIndex){case 0:// Front face (Z+)\nfacePosition=[0,0,size/2+0.001];faceRotation=[0,0,0];break;case 1:// Back face (Z-)\nfacePosition=[0,0,-size/2-0.001];faceRotation=[0,Math.PI,0];break;case 2:// Right face (X+)\nfacePosition=[size/2+0.001,0,0];faceRotation=[0,Math.PI/2,0];break;case 3:// Left face (X-)\nfacePosition=[-size/2-0.001,0,0];faceRotation=[0,-Math.PI/2,0];break;case 4:// Top face (Y+)\nfacePosition=[0,size/2+0.001,0];faceRotation=[-Math.PI/2,0,0];break;case 5:// Bottom face (Y-)\nfacePosition=[0,-size/2-0.001,0];faceRotation=[Math.PI/2,0,0];break;default:facePosition=[0,0,0];faceRotation=[0,0,0];}return/*#__PURE__*/_jsx(\"mesh\",{position:facePosition,rotation:faceRotation,geometry:faceGeometry,children:/*#__PURE__*/_jsx(\"meshPhongMaterial\",{color:colorMap[faceColor]||'#000000',side:THREE.FrontSide,emissive:colorMap[faceColor]||'#000000',emissiveIntensity:0.3})},faceIndex);}),[0,1,2,3,4,5].map(faceIndex=>{// Define face positions and rotations correctly (same as colored faces)\nlet facePosition,faceRotation;switch(faceIndex){case 0:// Front face (Z+)\nfacePosition=[0,0,size/2+0.002];faceRotation=[0,0,0];break;case 1:// Back face (Z-)\nfacePosition=[0,0,-size/2-0.002];faceRotation=[0,Math.PI,0];break;case 2:// Right face (X+)\nfacePosition=[size/2+0.002,0,0];faceRotation=[0,Math.PI/2,0];break;case 3:// Left face (X-)\nfacePosition=[-size/2-0.002,0,0];faceRotation=[0,-Math.PI/2,0];break;case 4:// Top face (Y+)\nfacePosition=[0,size/2+0.002,0];faceRotation=[-Math.PI/2,0,0];break;case 5:// Bottom face (Y-)\nfacePosition=[0,-size/2-0.002,0];faceRotation=[Math.PI/2,0,0];break;default:facePosition=[0,0,0];faceRotation=[0,0,0];}return/*#__PURE__*/_jsx(\"group\",{position:facePosition,rotation:faceRotation,children:createShape(pieceId,size*0.3)},\"shape-\".concat(faceIndex));})]});}// Custom hook for cube state management\nfunction useCubeState(){const[cubeState,setCubeState]=useState(()=>{const state=[];// Create 26 pieces (3x3x3 minus center)\nfor(let x=-1;x<=1;x++){for(let y=-1;y<=1;y++){for(let z=-1;z<=1;z++){// Skip the center piece\nif(x===0&&y===0&&z===0)continue;// Determine piece type and assign colors accordingly\nlet colors={front:'black',back:'black',right:'black',left:'black',top:'black',bottom:'black'};// Assign colors based on piece position in solved state\n// Only assign colors to faces that are visible (not internal)\nif(x===-1)colors.left='orange';if(x===1)colors.right='red';if(y===-1)colors.bottom='green';if(y===1)colors.top='blue';if(z===-1)colors.back='yellow';if(z===1)colors.front='white';// Debug logging for initial state\nconsole.log(\"Initial piece at [\".concat(x,\", \").concat(y,\", \").concat(z,\"]:\"),colors);state.push({position:[x,y,z],colors,rotationHistory:[]// Track all rotations this piece has undergone\n});}}}// Log the complete initial cube state as JSON\nconsole.log('ðŸŽ¯ INITIAL CUBE STATE (End of Initial Load):');console.log(JSON.stringify(state,null,2));// Also log to terminal (this will show in the terminal where npm start is running)\nlogToTerminal('INITIAL CUBE STATE (End of Initial Load)',state);return state;});const[isAnimating,setIsAnimating]=useState(false);// Consolidated rotation logic\nconst applyRotation=useCallback((pieces,face,direction)=>{pieces.forEach(piece=>{const[x,y,z]=piece.position;let newX=x,newY=y,newZ=z;// Apply 3D transformation\nswitch(face){case'F':// Front face rotation (Z+ plane)\nif(z===1){// Only pieces on the front face\nif(direction==='clockwise'){newX=-y;newY=x;}else{newX=y;newY=-x;}}break;case'B':// Back face rotation (Z- plane)\nif(z===-1){// Only pieces on the back face\nif(direction==='clockwise'){newX=y;newY=-x;}else{newX=-y;newY=x;}}break;case'R':// Right face rotation (X+ plane)\nif(x===1){// Only pieces on the right face\nif(direction==='clockwise'){newY=-z;newZ=y;}else{newY=z;newZ=-y;}}break;case'L':// Left face rotation (X- plane)\nif(x===-1){// Only pieces on the left face\nif(direction==='clockwise'){newY=z;newZ=-y;}else{newY=-z;newZ=y;}}break;case'U':// Up face rotation (Y+ plane)\nif(y===1){// Only pieces on the top face\nif(direction==='clockwise'){newX=-z;newZ=x;}else{newX=z;newZ=-x;}}break;case'D':// Down face rotation (Y- plane)\nif(y===-1){// Only pieces on the bottom face\nif(direction==='clockwise'){newX=z;newZ=-x;}else{newX=-z;newZ=x;}}break;}// Only apply changes if the piece actually moved\nconst positionChanged=x!==newX||y!==newY||z!==newZ;if(positionChanged){// Update position\npiece.position=[newX,newY,newZ];// Rotate the colors to match the piece's new orientation\nconst newColors=_objectSpread({},piece.colors);// Apply color rotation based on the face rotation\nswitch(face){case'F':// Front face rotation\nif(direction==='clockwise'){// Colors rotate: top -> right, right -> bottom, bottom -> left, left -> top\nconst temp=newColors.top;newColors.top=newColors.left;newColors.left=newColors.bottom;newColors.bottom=newColors.right;newColors.right=temp;}else{// Colors rotate: top -> left, left -> bottom, bottom -> right, right -> top\nconst temp=newColors.top;newColors.top=newColors.right;newColors.right=newColors.bottom;newColors.bottom=newColors.left;newColors.left=temp;}break;case'B':// Back face rotation\nif(direction==='clockwise'){// Colors rotate: top -> left, left -> bottom, bottom -> right, right -> top\nconst temp=newColors.top;newColors.top=newColors.right;newColors.right=newColors.bottom;newColors.bottom=newColors.left;newColors.left=temp;}else{// Colors rotate: top -> right, right -> bottom, bottom -> left, left -> top\nconst temp=newColors.top;newColors.top=newColors.left;newColors.left=newColors.bottom;newColors.bottom=newColors.right;newColors.right=temp;}break;case'R':// Right face rotation\nif(direction==='clockwise'){// Colors rotate: top -> back, back -> bottom, bottom -> front, front -> top\nconst temp=newColors.top;newColors.top=newColors.front;newColors.front=newColors.bottom;newColors.bottom=newColors.back;newColors.back=temp;}else{// Colors rotate: top -> front, front -> bottom, bottom -> back, back -> top\nconst temp=newColors.top;newColors.top=newColors.back;newColors.back=newColors.bottom;newColors.bottom=newColors.front;newColors.front=temp;}break;case'L':// Left face rotation\nif(direction==='clockwise'){// Colors rotate: top -> front, front -> bottom, bottom -> back, back -> top\nconst temp=newColors.top;newColors.top=newColors.back;newColors.back=newColors.bottom;newColors.bottom=newColors.front;newColors.front=temp;}else{// Colors rotate: top -> back, back -> bottom, bottom -> front, front -> top\nconst temp=newColors.top;newColors.top=newColors.front;newColors.front=newColors.bottom;newColors.bottom=newColors.back;newColors.back=temp;}break;case'U':// Up face rotation\nif(direction==='clockwise'){// Colors rotate: front -> right, right -> back, back -> left, left -> front\nconst temp=newColors.front;newColors.front=newColors.left;newColors.left=newColors.back;newColors.back=newColors.right;newColors.right=temp;}else{// Colors rotate: front -> left, left -> back, back -> right, right -> front\nconst temp=newColors.front;newColors.front=newColors.right;newColors.right=newColors.back;newColors.back=newColors.left;newColors.left=temp;}break;case'D':// Down face rotation\nif(direction==='clockwise'){// Colors rotate: front -> left, left -> back, back -> right, right -> front\nconst temp=newColors.front;newColors.front=newColors.right;newColors.right=newColors.back;newColors.back=newColors.left;newColors.left=temp;}else{// Colors rotate: front -> right, right -> back, back -> left, left -> front\nconst temp=newColors.front;newColors.front=newColors.left;newColors.left=newColors.back;newColors.back=newColors.right;newColors.right=temp;}break;}// Update the piece's colors\npiece.colors=newColors;piece.rotationHistory.push({move:face,direction:direction,fromPosition:[x,y,z],toPosition:[newX,newY,newZ],timestamp:new Date().toISOString()});}});},[]);// Rotate a face of the cube\nconst rotateFace=useCallback((face,direction)=>{if(isAnimating)return;setIsAnimating(true);setCubeState(prevState=>{const newState=[...prevState];const pieces=newState.map((piece,index)=>_objectSpread(_objectSpread({},piece),{},{pieceId:index}));// Apply rotation using consolidated logic\napplyRotation(pieces,face,direction);// Update the newState with the modified pieces\npieces.forEach((piece,index)=>{newState[index]={position:piece.position,colors:piece.colors,rotationHistory:piece.rotationHistory};});return newState;});// Reset animation state after a short delay\nsetTimeout(()=>setIsAnimating(false),100);},[isAnimating,applyRotation]);// Execute scramble sequence\nconst executeScramble=useCallback(sequence=>{if(sequence.length===0){setIsAnimating(false);// Log the complete cube state as JSON at the end of scramble session\n// We need to get the current state from the setter function\nsetCubeState(currentState=>{console.log('ðŸŽ¯ CUBE STATE AFTER SCRAMBLE (End of Scramble Session):');console.log(JSON.stringify(currentState,null,2));// Also log to terminal (this will show in the terminal where npm start is running)\nlogToTerminal('CUBE STATE AFTER SCRAMBLE (End of Scramble Session)',currentState);return currentState;// Return unchanged state\n});return;}const{move,direction}=sequence[0];console.log(\"Executing move: \".concat(move,\" \").concat(direction));// Apply the move using consolidated logic\nsetCubeState(prevState=>{const newState=[...prevState];const pieces=newState.map((piece,index)=>_objectSpread(_objectSpread({},piece),{},{pieceId:index}));// Apply rotation using consolidated logic\napplyRotation(pieces,move,direction);// Update the newState with the modified pieces\npieces.forEach((piece,index)=>{newState[index]={position:piece.position,colors:piece.colors,rotationHistory:piece.rotationHistory};});return newState;});// Continue with next move after a short delay\nsetTimeout(()=>executeScramble(sequence.slice(1)),100);},[applyRotation]);// Scramble the cube\nconst scramble=useCallback(()=>{if(isAnimating)return;setIsAnimating(true);const moves=['F','B','R','L','U','D'];const directions=['clockwise','counterclockwise'];const scrambleSequence=[];// Generate 20 random moves\nfor(let i=0;i<20;i++){const move=moves[Math.floor(Math.random()*moves.length)];const direction=directions[Math.floor(Math.random()*directions.length)];scrambleSequence.push({move,direction});}console.log('Scrambling with sequence:',scrambleSequence);// Execute scramble moves\nexecuteScramble(scrambleSequence);},[isAnimating,executeScramble]);// Reset the cube to solved state\nconst reset=useCallback(()=>{setCubeState(()=>{const state=[];// Create 26 pieces (3x3x3 minus center)\nfor(let x=-1;x<=1;x++){for(let y=-1;y<=1;y++){for(let z=-1;z<=1;z++){// Skip the center piece\nif(x===0&&y===0&&z===0)continue;// Determine piece type and assign colors accordingly\nlet colors={front:'black',back:'black',right:'black',left:'black',top:'black',bottom:'black'};// Assign colors based on piece position in solved state\n// Only assign colors to faces that are visible (not internal)\nif(x===-1)colors.left='orange';if(x===1)colors.right='red';if(y===-1)colors.bottom='green';if(y===1)colors.top='blue';if(z===-1)colors.back='yellow';if(z===1)colors.front='white';// Debug logging for reset state\nconsole.log(\"Reset piece at [\".concat(x,\", \").concat(y,\", \").concat(z,\"]:\"),colors);state.push({position:[x,y,z],colors,rotationHistory:[]// Reset rotation history\n});}}}return state;});},[]);return{cubeState,isAnimating,rotateFace,scramble,reset};}// Main cube group component with enhanced structure\nfunction CubeGroup(_ref2){let{isRotating,autoRotate=false,onScramble,onReset,onCubeStateChange}=_ref2;const groupRef=useRef();const[rotationSpeed]=useState({x:0.005,y:0.01});const{cubeState,isAnimating,rotateFace,scramble,reset}=useCubeState();// Helper functions for enhanced debugging\nconst getShapeType=pieceId=>{const shapeTypes=['Square','Square','Square','Square','Square','Circle','Circle','Circle','Circle','Circle','Triangle','Triangle','Triangle','Triangle','Triangle','Diamond','Diamond','Diamond','Diamond','Diamond','Square+White','Square+White','Square+White','Square+White','Square+White','Square+White'];return shapeTypes[pieceId]||'Unknown';};const getShapeColor=pieceId=>{const shapeColors=['Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Red','Blue','Green','Orange','Purple','Cyan'];return shapeColors[pieceId]||'Unknown';};const getExpectedPosition=pieceId=>{// Map pieceId to expected solved position\nconst positions=[];for(let x=-1;x<=1;x++){for(let y=-1;y<=1;y++){for(let z=-1;z<=1;z++){if(x===0&&y===0&&z===0)continue;positions.push([x,y,z]);}}}return positions[pieceId];};const getExpectedColorsForPosition=position=>{const[x,y,z]=position;const expectedColors={front:'black',back:'black',right:'black',left:'black',top:'black',bottom:'black'};if(x===-1)expectedColors.left='orange';if(x===1)expectedColors.right='red';if(y===-1)expectedColors.bottom='green';if(y===1)expectedColors.top='blue';if(z===-1)expectedColors.back='yellow';if(z===1)expectedColors.front='white';return expectedColors;};const isPieceInCorrectPosition=(piece,pieceId)=>{// Check if piece is in its solved position\nconst[x,y,z]=piece.position;const expectedPosition=getExpectedPosition(pieceId);return x===expectedPosition[0]&&y===expectedPosition[1]&&z===expectedPosition[2];};const getColorMismatches=piece=>{// In a scrambled cube, there are no color mismatches based on position\n// Colors should only be validated against the solved state, not current position\n// This function is mainly for debugging and should not flag scrambled pieces as incorrect\nreturn[];};const getVisibleFaces=position=>{const[x,y,z]=position;const visibleFaces=[];if(x===1)visibleFaces.push('right');if(x===-1)visibleFaces.push('left');if(y===1)visibleFaces.push('top');if(y===-1)visibleFaces.push('bottom');if(z===1)visibleFaces.push('front');if(z===-1)visibleFaces.push('back');return visibleFaces;};const getVisibleColors=piece=>{const visibleFaces=getVisibleFaces(piece.position);return visibleFaces.map(face=>({face,color:piece.colors[face]}));};const isCubeSolved=state=>{return state.every((piece,index)=>isPieceInCorrectPosition(piece,index));};// Expose functions to parent\nReact.useEffect(()=>{if(onScramble)onScramble(scramble);if(onReset)onReset(reset);},[onScramble,onReset,scramble,reset]);// Notify parent of cube state changes with enhanced debugging info\nReact.useEffect(()=>{if(onCubeStateChange&&cubeState){console.log('ðŸ” Cube state changed, pieces count:',cubeState.length);console.log('ðŸ” First few pieces:',cubeState.slice(0,3));// Create enhanced cube state with debugging information\nconst enhancedCubeState={timestamp:new Date().toISOString(),totalPieces:cubeState.length,pieces:cubeState.map((piece,index)=>({pieceId:index,position:piece.position,colors:piece.colors,rotationHistory:piece.rotationHistory,shapeType:getShapeType(index),shapeColor:getShapeColor(index),// Validation data\nvalidation:{isInCorrectPosition:isPieceInCorrectPosition(piece,index),expectedColors:getExpectedColorsForPosition(piece.position),colorMismatches:getColorMismatches(piece),visibleFaces:getVisibleFaces(piece.position),visibleColors:getVisibleColors(piece)},// Debugging helpers\ndebug:{positionString:\"[\".concat(piece.position.join(', '),\"]\"),colorSummary:Object.entries(piece.colors).filter(_ref3=>{let[_,color]=_ref3;return color!=='black';}).map(_ref4=>{let[face,color]=_ref4;return\"\".concat(face,\":\").concat(color);}).join(', '),moveCount:piece.rotationHistory.length,lastMove:piece.rotationHistory[piece.rotationHistory.length-1]||null}})),// Global validation\nvalidation:{isSolved:isCubeSolved(cubeState),totalMoves:cubeState.reduce((sum,piece)=>sum+piece.rotationHistory.length,0),piecesInCorrectPosition:cubeState.filter((piece,index)=>isPieceInCorrectPosition(piece,index)).length,piecesWithColorMismatches:0,// No color mismatches in scrambled state\nisScrambled:!isCubeSolved(cubeState)&&cubeState.some(piece=>piece.rotationHistory.length>0)},// Metadata\nmetadata:{version:\"1.0.0\",exportReason:\"debugging\",cubeType:\"3x3x3\",coordinateSystem:\"right-handed (X-right, Y-up, Z-front)\",faceMapping:{front:\"Z+ (white)\",back:\"Z- (yellow)\",right:\"X+ (red)\",left:\"X- (orange)\",top:\"Y+ (blue)\",bottom:\"Y- (green)\"},shapeMapping:{\"0-4\":\"Squares (Red, Blue, Green, Orange, Purple)\",\"5-9\":\"Circles (Red, Blue, Green, Orange, Purple)\",\"10-14\":\"Triangles (Red, Blue, Green, Orange, Purple)\",\"15-19\":\"Diamonds (Red, Blue, Green, Orange, Purple)\",\"20-25\":\"Squares+White (Red, Blue, Green, Orange, Purple, Cyan)\"}}};onCubeStateChange(enhancedCubeState);}},[onCubeStateChange,cubeState]);// Auto-rotation animation\nuseFrame(()=>{if(groupRef.current&&isRotating&&!isAnimating){groupRef.current.rotation.x+=rotationSpeed.x;groupRef.current.rotation.y+=rotationSpeed.y;}});return/*#__PURE__*/_jsx(\"group\",{ref:groupRef,children:cubeState.map((piece,index)=>/*#__PURE__*/_jsx(CubePiece,{position:piece.position,colors:piece.colors,pieceId:index},index))});}// Main Rubik's Cube component\nfunction RubiksCube(_ref5){let{isRotating,autoRotate=false,onScramble,onReset,onCubeStateChange}=_ref5;const groupRef=useRef();const[rotationSpeed]=useState({x:0.005,y:0.01});const{cubeState,isAnimating,rotateFace,scramble,reset}=useCubeState();// Expose functions to parent\nReact.useEffect(()=>{if(onScramble)onScramble(scramble);if(onReset)onReset(reset);},[onScramble,onReset,scramble,reset]);// Notify parent of cube state changes\nReact.useEffect(()=>{if(onCubeStateChange&&cubeState){onCubeStateChange(cubeState);}},[onCubeStateChange,cubeState]);return/*#__PURE__*/_jsxs(Canvas,{camera:{position:[5,5,5],fov:50},style:{width:'100%',height:'100%'},children:[/*#__PURE__*/_jsx(\"ambientLight\",{intensity:1.2}),/*#__PURE__*/_jsx(\"directionalLight\",{position:[10,10,5],intensity:3.0}),/*#__PURE__*/_jsx(\"pointLight\",{position:[10,10,10],intensity:2.0}),/*#__PURE__*/_jsx(\"pointLight\",{position:[-10,-10,-10],intensity:2.0}),/*#__PURE__*/_jsx(\"spotLight\",{position:[0,10,0],angle:0.3,penumbra:1,intensity:2.0,castShadow:true}),/*#__PURE__*/_jsx(Environment,{preset:\"sunset\"}),/*#__PURE__*/_jsx(CubeGroup,{isRotating:isRotating,autoRotate:autoRotate,onScramble:onScramble,onReset:onReset,onCubeStateChange:onCubeStateChange}),/*#__PURE__*/_jsx(OrbitControls,{enablePan:true,enableZoom:true,enableRotate:true})]});}export default RubiksCube;","map":{"version":3,"names":["React","useState","useRef","useMemo","useCallback","useEffect","Canvas","useFrame","OrbitControls","Environment","THREE","jsx","_jsx","jsxs","_jsxs","logToTerminal","message","data","arguments","length","undefined","console","log","concat","JSON","stringify","repeat","fetch","method","headers","body","then","response","ok","Error","status","catch","error","createShape","pieceId","size","shapes","position","children","args","color","rotation","Math","PI","shapeIndex","CubePiece","_ref","colors","meshRef","shapeTypes","shapeColors","shapeType","shapeColor","join","x","y","z","visibleFaces","push","map","face","colorMap","cubeGeometry","BoxGeometry","faceGeometry","geometry","PlaneGeometry","getFaceColor","faceIndex","faceColor","front","back","right","left","top","bottom","includes","faceNames","facePosition","faceRotation","side","FrontSide","emissive","emissiveIntensity","useCubeState","cubeState","setCubeState","state","rotationHistory","isAnimating","setIsAnimating","applyRotation","pieces","direction","forEach","piece","newX","newY","newZ","positionChanged","newColors","_objectSpread","temp","move","fromPosition","toPosition","timestamp","Date","toISOString","rotateFace","prevState","newState","index","setTimeout","executeScramble","sequence","currentState","slice","scramble","moves","directions","scrambleSequence","i","floor","random","reset","CubeGroup","_ref2","isRotating","autoRotate","onScramble","onReset","onCubeStateChange","groupRef","rotationSpeed","getShapeType","getShapeColor","getExpectedPosition","positions","getExpectedColorsForPosition","expectedColors","isPieceInCorrectPosition","expectedPosition","getColorMismatches","getVisibleFaces","getVisibleColors","isCubeSolved","every","enhancedCubeState","totalPieces","validation","isInCorrectPosition","colorMismatches","visibleColors","debug","positionString","colorSummary","Object","entries","filter","_ref3","_","_ref4","moveCount","lastMove","isSolved","totalMoves","reduce","sum","piecesInCorrectPosition","piecesWithColorMismatches","isScrambled","some","metadata","version","exportReason","cubeType","coordinateSystem","faceMapping","shapeMapping","current","ref","RubiksCube","_ref5","camera","fov","style","width","height","intensity","angle","penumbra","castShadow","preset","enablePan","enableZoom","enableRotate"],"sources":["C:/Repo/GitHub/rubiks-cube/src/components/RubiksCube.js"],"sourcesContent":["import React, { useState, useRef, useMemo, useCallback, useEffect } from 'react';\r\nimport { Canvas, useFrame } from '@react-three/fiber';\r\nimport { OrbitControls, Environment } from '@react-three/drei';\r\nimport * as THREE from 'three';\r\n\r\n// Custom logging function that will be visible in terminal\r\nconst logToTerminal = (message, data = null) => {\r\n  // Log to browser console\r\n  console.log(`\\nðŸŽ¯ ${message}`);\r\n  if (data) {\r\n    console.log(JSON.stringify(data, null, 2));\r\n  }\r\n  console.log('='.repeat(80) + '\\n');\r\n  \r\n  // Send to log server to print in terminal\r\n  fetch('http://localhost:3001/log', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify({\r\n      message: message,\r\n      data: data\r\n    })\r\n  })\r\n  .then(response => {\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n    console.log('âœ… Log sent to terminal successfully');\r\n  })\r\n  .catch(error => {\r\n    console.error('âŒ Could not send log to terminal server:', error);\r\n    console.log('ðŸ’¡ Make sure the log server is running with: npm run log-server');\r\n  });\r\n};\r\n\r\n// Function to create unique shapes for each piece\r\nfunction createShape(pieceId, size) {\r\n  const shapes = [\r\n    // 0-4: Basic geometric shapes (Squares)\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"red\" /></mesh>, // Square\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"blue\" /></mesh>, // Square\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"green\" /></mesh>, // Square\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"orange\" /></mesh>, // Square\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"purple\" /></mesh>, // Square\r\n\r\n    // 5-9: Circles\r\n    () => <mesh position={[0, 0, 0.012]}><circleGeometry args={[size/2, 32]} /><meshBasicMaterial color=\"red\" /></mesh>, // Circle\r\n    () => <mesh position={[0, 0, 0.012]}><circleGeometry args={[size/2, 32]} /><meshBasicMaterial color=\"blue\" /></mesh>, // Circle\r\n    () => <mesh position={[0, 0, 0.012]}><circleGeometry args={[size/2, 32]} /><meshBasicMaterial color=\"green\" /></mesh>, // Circle\r\n    () => <mesh position={[0, 0, 0.012]}><circleGeometry args={[size/2, 32]} /><meshBasicMaterial color=\"orange\" /></mesh>, // Circle\r\n    () => <mesh position={[0, 0, 0.012]}><circleGeometry args={[size/2, 32]} /><meshBasicMaterial color=\"purple\" /></mesh>, // Circle\r\n\r\n    // 10-14: Triangles (using planeGeometry for now, ideally custom geometry)\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"red\" /></mesh>, // Triangle\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"blue\" /></mesh>, // Triangle\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"green\" /></mesh>, // Triangle\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"orange\" /></mesh>, // Triangle\r\n    () => <mesh position={[0, 0, 0.012]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"purple\" /></mesh>, // Triangle\r\n\r\n    // 15-19: Diamonds (rotated squares)\r\n    () => <group position={[0, 0, 0.012]}><mesh rotation={[0, 0, Math.PI/4]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"red\" /></mesh></group>, // Diamond\r\n    () => <group position={[0, 0, 0.012]}><mesh rotation={[0, 0, Math.PI/4]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"blue\" /></mesh></group>, // Diamond\r\n    () => <group position={[0, 0, 0.012]}><mesh rotation={[0, 0, Math.PI/4]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"green\" /></mesh></group>, // Diamond\r\n    () => <group position={[0, 0, 0.012]}><mesh rotation={[0, 0, Math.PI/4]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"orange\" /></mesh></group>, // Diamond\r\n    () => <group position={[0, 0, 0.012]}><mesh rotation={[0, 0, Math.PI/4]}><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"purple\" /></mesh></group>, // Diamond\r\n\r\n    // 20-25: Complex patterns (Squares with white centers)\r\n    () => <group position={[0, 0, 0.012]}><mesh><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"red\" /></mesh><mesh position={[0, 0, 0.001]}><planeGeometry args={[size*0.5, size*0.5]} /><meshBasicMaterial color=\"white\" /></mesh></group>, // Square with white center\r\n    () => <group position={[0, 0, 0.012]}><mesh><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"blue\" /></mesh><mesh position={[0, 0, 0.001]}><planeGeometry args={[size*0.5, size*0.5]} /><meshBasicMaterial color=\"white\" /></mesh></group>, // Square with white center\r\n    () => <group position={[0, 0, 0.012]}><mesh><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"green\" /></mesh><mesh position={[0, 0, 0.001]}><planeGeometry args={[size*0.5, size*0.5]} /><meshBasicMaterial color=\"white\" /></mesh></group>, // Square with white center\r\n    () => <group position={[0, 0, 0.012]}><mesh><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"orange\" /></mesh><mesh position={[0, 0, 0.001]}><planeGeometry args={[size*0.5, size*0.5]} /><meshBasicMaterial color=\"white\" /></mesh></group>, // Square with white center\r\n    () => <group position={[0, 0, 0.012]}><mesh><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"purple\" /></mesh><mesh position={[0, 0, 0.001]}><planeGeometry args={[size*0.5, size*0.5]} /><meshBasicMaterial color=\"white\" /></mesh></group>, // Square with white center\r\n    () => <group position={[0, 0, 0.012]}><mesh><planeGeometry args={[size, size]} /><meshBasicMaterial color=\"cyan\" /></mesh><mesh position={[0, 0, 0.001]}><planeGeometry args={[size*0.5, size*0.5]} /><meshBasicMaterial color=\"white\" /></mesh></group> // Square with white center\r\n  ];\r\n  \r\n  const shapeIndex = pieceId; // Changed from pieceId % shapes.length\r\n  return shapes[shapeIndex]();\r\n}\r\n\r\n// Individual cube piece component\r\nfunction CubePiece({ position, colors, size = 0.95, pieceId = 0 }) {\r\n  const meshRef = useRef();\r\n  \r\n  // Log piece information for debugging\r\n  React.useEffect(() => {\r\n    const shapeTypes = ['Square', 'Square', 'Square', 'Square', 'Square', 'Circle', 'Circle', 'Circle', 'Circle', 'Circle', 'Triangle', 'Triangle', 'Triangle', 'Triangle', 'Triangle', 'Diamond', 'Diamond', 'Diamond', 'Diamond', 'Diamond', 'Square+White', 'Square+White', 'Square+White', 'Square+White', 'Square+White', 'Square+White'];\r\n    const shapeColors = ['Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Cyan'];\r\n    \r\n    const shapeType = shapeTypes[pieceId] || 'Unknown'; // Changed from pieceId % shapeTypes.length\r\n    const shapeColor = shapeColors[pieceId] || 'Unknown'; // Changed from pieceId % shapeColors.length\r\n    \r\n    // Debug specific pieces only\r\n    if (pieceId === 0 || pieceId === 17 || pieceId === 25 || pieceId === 1 || pieceId === 11) {\r\n      console.log(`ðŸ” ${shapeColor} ${shapeType} Piece ${pieceId} at position [${position.join(', ')}]`);\r\n      console.log(`  Stored Colors:`, colors);\r\n      \r\n      // Show what colors should be visible based on position\r\n      const [x, y, z] = position;\r\n      const visibleFaces = [];\r\n      if (x === 1) visibleFaces.push('right');\r\n      if (x === -1) visibleFaces.push('left');\r\n      if (y === 1) visibleFaces.push('top');\r\n      if (y === -1) visibleFaces.push('bottom');\r\n      if (z === 1) visibleFaces.push('front');\r\n      if (z === -1) visibleFaces.push('back');\r\n      \r\n      console.log(`  Visible faces:`, visibleFaces);\r\n      console.log(`  Colors on visible faces:`, visibleFaces.map(face => `${face}: ${colors[face]}`));\r\n    }\r\n  }, [pieceId, position, colors]);\r\n\r\n  // Color mapping\r\n  const colorMap = {\r\n    'white': '#FFFFFF',\r\n    'yellow': '#FFD700',\r\n    'red': '#FF0000',\r\n    'orange': '#FFA500',\r\n    'blue': '#0000FF',\r\n    'green': '#00FF00',\r\n    'black': '#000000'\r\n  };\r\n\r\n  // Create cube geometry\r\n  const cubeGeometry = useMemo(() => new THREE.BoxGeometry(size, size, size), [size]);\r\n  \r\n  // Create face geometry\r\n  const faceGeometry = useMemo(() => {\r\n    const geometry = new THREE.PlaneGeometry(size, size);\r\n    return geometry;\r\n  }, [size]);\r\n\r\n  // Get the color for a face based on the face index and position\r\n  const getFaceColor = (faceIndex) => {\r\n    const [x, y, z] = position;\r\n    \r\n    // Determine which faces are visible based on position\r\n    const visibleFaces = [];\r\n    if (x === 1) visibleFaces.push(2); // Right face visible\r\n    if (x === -1) visibleFaces.push(3); // Left face visible\r\n    if (y === 1) visibleFaces.push(4); // Top face visible\r\n    if (y === -1) visibleFaces.push(5); // Bottom face visible\r\n    if (z === 1) visibleFaces.push(0); // Front face visible\r\n    if (z === -1) visibleFaces.push(1); // Back face visible\r\n    \r\n    // Map face index to color property\r\n    let faceColor;\r\n    switch (faceIndex) {\r\n      case 0: faceColor = colors.front; break;  // Front face\r\n      case 1: faceColor = colors.back; break;   // Back face\r\n      case 2: faceColor = colors.right; break;  // Right face\r\n      case 3: faceColor = colors.left; break;   // Left face\r\n      case 4: faceColor = colors.top; break;    // Top face\r\n      case 5: faceColor = colors.bottom; break; // Bottom face\r\n      default: faceColor = 'black';\r\n    }\r\n    \r\n    // If this face is not visible, return black\r\n    if (!visibleFaces.includes(faceIndex)) {\r\n      return 'black';\r\n    }\r\n    \r\n    // Debug logging for specific pieces\r\n    if (pieceId === 2 || pieceId === 11 || pieceId === 16 || pieceId === 19 || pieceId === 22 || pieceId === 25) {\r\n      const faceNames = ['front', 'back', 'right', 'left', 'top', 'bottom'];\r\n      console.log(`ðŸŽ¨ Piece ${pieceId} face ${faceNames[faceIndex]} (${faceIndex}) at [${x},${y},${z}]: ${faceColor} (visible: ${visibleFaces.includes(faceIndex)})`);\r\n    }\r\n    \r\n    return faceColor;\r\n  };\r\n\r\n  return (\r\n    <group position={position}>\r\n      {/* Solid cube base */}\r\n      <mesh geometry={cubeGeometry}>\r\n        <meshPhongMaterial color=\"#333333\" />\r\n      </mesh>\r\n      \r\n      {/* Colored faces */}\r\n      {[0, 1, 2, 3, 4, 5].map((faceIndex) => {\r\n        const faceColor = getFaceColor(faceIndex);\r\n        \r\n        // Define face positions and rotations correctly\r\n        let facePosition, faceRotation;\r\n        \r\n        switch (faceIndex) {\r\n          case 0: // Front face (Z+)\r\n            facePosition = [0, 0, size/2 + 0.001];\r\n            faceRotation = [0, 0, 0];\r\n            break;\r\n          case 1: // Back face (Z-)\r\n            facePosition = [0, 0, -size/2 - 0.001];\r\n            faceRotation = [0, Math.PI, 0];\r\n            break;\r\n          case 2: // Right face (X+)\r\n            facePosition = [size/2 + 0.001, 0, 0];\r\n            faceRotation = [0, Math.PI/2, 0];\r\n            break;\r\n          case 3: // Left face (X-)\r\n            facePosition = [-size/2 - 0.001, 0, 0];\r\n            faceRotation = [0, -Math.PI/2, 0];\r\n            break;\r\n          case 4: // Top face (Y+)\r\n            facePosition = [0, size/2 + 0.001, 0];\r\n            faceRotation = [-Math.PI/2, 0, 0];\r\n            break;\r\n          case 5: // Bottom face (Y-)\r\n            facePosition = [0, -size/2 - 0.001, 0];\r\n            faceRotation = [Math.PI/2, 0, 0];\r\n            break;\r\n          default:\r\n            facePosition = [0, 0, 0];\r\n            faceRotation = [0, 0, 0];\r\n        }\r\n        \r\n        return (\r\n          <mesh\r\n            key={faceIndex}\r\n            position={facePosition}\r\n            rotation={faceRotation}\r\n            geometry={faceGeometry}\r\n          >\r\n            <meshPhongMaterial \r\n              color={colorMap[faceColor] || '#000000'} \r\n              side={THREE.FrontSide}\r\n              emissive={colorMap[faceColor] || '#000000'}\r\n              emissiveIntensity={0.3}\r\n            />\r\n          </mesh>\r\n        );\r\n      })}\r\n      \r\n      {/* Debug shape on all faces */}\r\n      {[0, 1, 2, 3, 4, 5].map((faceIndex) => {\r\n        // Define face positions and rotations correctly (same as colored faces)\r\n        let facePosition, faceRotation;\r\n        \r\n        switch (faceIndex) {\r\n          case 0: // Front face (Z+)\r\n            facePosition = [0, 0, size/2 + 0.002];\r\n            faceRotation = [0, 0, 0];\r\n            break;\r\n          case 1: // Back face (Z-)\r\n            facePosition = [0, 0, -size/2 - 0.002];\r\n            faceRotation = [0, Math.PI, 0];\r\n            break;\r\n          case 2: // Right face (X+)\r\n            facePosition = [size/2 + 0.002, 0, 0];\r\n            faceRotation = [0, Math.PI/2, 0];\r\n            break;\r\n          case 3: // Left face (X-)\r\n            facePosition = [-size/2 - 0.002, 0, 0];\r\n            faceRotation = [0, -Math.PI/2, 0];\r\n            break;\r\n          case 4: // Top face (Y+)\r\n            facePosition = [0, size/2 + 0.002, 0];\r\n            faceRotation = [-Math.PI/2, 0, 0];\r\n            break;\r\n          case 5: // Bottom face (Y-)\r\n            facePosition = [0, -size/2 - 0.002, 0];\r\n            faceRotation = [Math.PI/2, 0, 0];\r\n            break;\r\n          default:\r\n            facePosition = [0, 0, 0];\r\n            faceRotation = [0, 0, 0];\r\n        }\r\n        \r\n        return (\r\n          <group key={`shape-${faceIndex}`} position={facePosition} rotation={faceRotation}>\r\n            {createShape(pieceId, size * 0.3)}\r\n          </group>\r\n        );\r\n      })}\r\n    </group>\r\n  );\r\n}\r\n\r\n// Custom hook for cube state management\r\nfunction useCubeState() {\r\n  const [cubeState, setCubeState] = useState(() => {\r\n    const state = [];\r\n    \r\n    // Create 26 pieces (3x3x3 minus center)\r\n    for (let x = -1; x <= 1; x++) {\r\n      for (let y = -1; y <= 1; y++) {\r\n        for (let z = -1; z <= 1; z++) {\r\n          // Skip the center piece\r\n          if (x === 0 && y === 0 && z === 0) continue;\r\n          \r\n          // Determine piece type and assign colors accordingly\r\n          let colors = {\r\n            front: 'black',\r\n            back: 'black', \r\n            right: 'black',\r\n            left: 'black',\r\n            top: 'black',\r\n            bottom: 'black'\r\n          };\r\n          \r\n          // Assign colors based on piece position in solved state\r\n          // Only assign colors to faces that are visible (not internal)\r\n          if (x === -1) colors.left = 'orange';\r\n          if (x === 1) colors.right = 'red';\r\n          if (y === -1) colors.bottom = 'green';\r\n          if (y === 1) colors.top = 'blue';\r\n          if (z === -1) colors.back = 'yellow';\r\n          if (z === 1) colors.front = 'white';\r\n          \r\n          // Debug logging for initial state\r\n          console.log(`Initial piece at [${x}, ${y}, ${z}]:`, colors);\r\n          \r\n          state.push({ \r\n            position: [x, y, z], \r\n            colors,\r\n            rotationHistory: [] // Track all rotations this piece has undergone\r\n          });\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Log the complete initial cube state as JSON\r\n    console.log('ðŸŽ¯ INITIAL CUBE STATE (End of Initial Load):');\r\n    console.log(JSON.stringify(state, null, 2));\r\n    \r\n    // Also log to terminal (this will show in the terminal where npm start is running)\r\n    logToTerminal('INITIAL CUBE STATE (End of Initial Load)', state);\r\n    \r\n    return state;\r\n  });\r\n\r\n  const [isAnimating, setIsAnimating] = useState(false);\r\n\r\n  // Consolidated rotation logic\r\n  const applyRotation = useCallback((pieces, face, direction) => {\r\n    pieces.forEach(piece => {\r\n      const [x, y, z] = piece.position;\r\n      let newX = x, newY = y, newZ = z;\r\n      // Apply 3D transformation\r\n      switch (face) {\r\n        case 'F': // Front face rotation (Z+ plane)\r\n          if (z === 1) { // Only pieces on the front face\r\n            if (direction === 'clockwise') {\r\n              newX = -y;\r\n              newY = x;\r\n            } else {\r\n              newX = y;\r\n              newY = -x;\r\n            }\r\n          }\r\n          break;\r\n        case 'B': // Back face rotation (Z- plane)\r\n          if (z === -1) { // Only pieces on the back face\r\n            if (direction === 'clockwise') {\r\n              newX = y;\r\n              newY = -x;\r\n            } else {\r\n              newX = -y;\r\n              newY = x;\r\n            }\r\n          }\r\n          break;\r\n        case 'R': // Right face rotation (X+ plane)\r\n          if (x === 1) { // Only pieces on the right face\r\n            if (direction === 'clockwise') {\r\n              newY = -z;\r\n              newZ = y;\r\n            } else {\r\n              newY = z;\r\n              newZ = -y;\r\n            }\r\n          }\r\n          break;\r\n        case 'L': // Left face rotation (X- plane)\r\n          if (x === -1) { // Only pieces on the left face\r\n            if (direction === 'clockwise') {\r\n              newY = z;\r\n              newZ = -y;\r\n            } else {\r\n              newY = -z;\r\n              newZ = y;\r\n            }\r\n          }\r\n          break;\r\n        case 'U': // Up face rotation (Y+ plane)\r\n          if (y === 1) { // Only pieces on the top face\r\n            if (direction === 'clockwise') {\r\n              newX = -z;\r\n              newZ = x;\r\n            } else {\r\n              newX = z;\r\n              newZ = -x;\r\n            }\r\n          }\r\n          break;\r\n        case 'D': // Down face rotation (Y- plane)\r\n          if (y === -1) { // Only pieces on the bottom face\r\n            if (direction === 'clockwise') {\r\n              newX = z;\r\n              newZ = -x;\r\n            } else {\r\n              newX = -z;\r\n              newZ = x;\r\n            }\r\n          }\r\n          break;\r\n      }\r\n      \r\n      // Only apply changes if the piece actually moved\r\n      const positionChanged = (x !== newX || y !== newY || z !== newZ);\r\n      \r\n      if (positionChanged) {\r\n        // Update position\r\n        piece.position = [newX, newY, newZ];\r\n        \r\n        // Rotate the colors to match the piece's new orientation\r\n        const newColors = { ...piece.colors };\r\n        \r\n        // Apply color rotation based on the face rotation\r\n        switch (face) {\r\n          case 'F': // Front face rotation\r\n            if (direction === 'clockwise') {\r\n              // Colors rotate: top -> right, right -> bottom, bottom -> left, left -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.left;\r\n              newColors.left = newColors.bottom;\r\n              newColors.bottom = newColors.right;\r\n              newColors.right = temp;\r\n            } else {\r\n              // Colors rotate: top -> left, left -> bottom, bottom -> right, right -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.right;\r\n              newColors.right = newColors.bottom;\r\n              newColors.bottom = newColors.left;\r\n              newColors.left = temp;\r\n            }\r\n            break;\r\n          case 'B': // Back face rotation\r\n            if (direction === 'clockwise') {\r\n              // Colors rotate: top -> left, left -> bottom, bottom -> right, right -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.right;\r\n              newColors.right = newColors.bottom;\r\n              newColors.bottom = newColors.left;\r\n              newColors.left = temp;\r\n            } else {\r\n              // Colors rotate: top -> right, right -> bottom, bottom -> left, left -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.left;\r\n              newColors.left = newColors.bottom;\r\n              newColors.bottom = newColors.right;\r\n              newColors.right = temp;\r\n            }\r\n            break;\r\n          case 'R': // Right face rotation\r\n            if (direction === 'clockwise') {\r\n              // Colors rotate: top -> back, back -> bottom, bottom -> front, front -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.front;\r\n              newColors.front = newColors.bottom;\r\n              newColors.bottom = newColors.back;\r\n              newColors.back = temp;\r\n            } else {\r\n              // Colors rotate: top -> front, front -> bottom, bottom -> back, back -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.back;\r\n              newColors.back = newColors.bottom;\r\n              newColors.bottom = newColors.front;\r\n              newColors.front = temp;\r\n            }\r\n            break;\r\n          case 'L': // Left face rotation\r\n            if (direction === 'clockwise') {\r\n              // Colors rotate: top -> front, front -> bottom, bottom -> back, back -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.back;\r\n              newColors.back = newColors.bottom;\r\n              newColors.bottom = newColors.front;\r\n              newColors.front = temp;\r\n            } else {\r\n              // Colors rotate: top -> back, back -> bottom, bottom -> front, front -> top\r\n              const temp = newColors.top;\r\n              newColors.top = newColors.front;\r\n              newColors.front = newColors.bottom;\r\n              newColors.bottom = newColors.back;\r\n              newColors.back = temp;\r\n            }\r\n            break;\r\n          case 'U': // Up face rotation\r\n            if (direction === 'clockwise') {\r\n              // Colors rotate: front -> right, right -> back, back -> left, left -> front\r\n              const temp = newColors.front;\r\n              newColors.front = newColors.left;\r\n              newColors.left = newColors.back;\r\n              newColors.back = newColors.right;\r\n              newColors.right = temp;\r\n            } else {\r\n              // Colors rotate: front -> left, left -> back, back -> right, right -> front\r\n              const temp = newColors.front;\r\n              newColors.front = newColors.right;\r\n              newColors.right = newColors.back;\r\n              newColors.back = newColors.left;\r\n              newColors.left = temp;\r\n            }\r\n            break;\r\n          case 'D': // Down face rotation\r\n            if (direction === 'clockwise') {\r\n              // Colors rotate: front -> left, left -> back, back -> right, right -> front\r\n              const temp = newColors.front;\r\n              newColors.front = newColors.right;\r\n              newColors.right = newColors.back;\r\n              newColors.back = newColors.left;\r\n              newColors.left = temp;\r\n            } else {\r\n              // Colors rotate: front -> right, right -> back, back -> left, left -> front\r\n              const temp = newColors.front;\r\n              newColors.front = newColors.left;\r\n              newColors.left = newColors.back;\r\n              newColors.back = newColors.right;\r\n              newColors.right = temp;\r\n            }\r\n            break;\r\n        }\r\n        \r\n        // Update the piece's colors\r\n        piece.colors = newColors;\r\n        \r\n        piece.rotationHistory.push({\r\n          move: face,\r\n          direction: direction,\r\n          fromPosition: [x, y, z],\r\n          toPosition: [newX, newY, newZ],\r\n          timestamp: new Date().toISOString()\r\n        });\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  // Rotate a face of the cube\r\n  const rotateFace = useCallback((face, direction) => {\r\n    if (isAnimating) return;\r\n    \r\n    setIsAnimating(true);\r\n    \r\n    setCubeState(prevState => {\r\n      const newState = [...prevState];\r\n      const pieces = newState.map((piece, index) => ({ ...piece, pieceId: index }));\r\n      \r\n      // Apply rotation using consolidated logic\r\n      applyRotation(pieces, face, direction);\r\n\r\n      // Update the newState with the modified pieces\r\n      pieces.forEach((piece, index) => {\r\n        newState[index] = {\r\n          position: piece.position,\r\n          colors: piece.colors,\r\n          rotationHistory: piece.rotationHistory\r\n        };\r\n      });\r\n      \r\n      return newState;\r\n    });\r\n    \r\n    // Reset animation state after a short delay\r\n    setTimeout(() => setIsAnimating(false), 100);\r\n  }, [isAnimating, applyRotation]);\r\n\r\n  // Execute scramble sequence\r\n  const executeScramble = useCallback((sequence) => {\r\n    if (sequence.length === 0) {\r\n      setIsAnimating(false);\r\n      \r\n      // Log the complete cube state as JSON at the end of scramble session\r\n      // We need to get the current state from the setter function\r\n      setCubeState(currentState => {\r\n        console.log('ðŸŽ¯ CUBE STATE AFTER SCRAMBLE (End of Scramble Session):');\r\n        console.log(JSON.stringify(currentState, null, 2));\r\n        \r\n        // Also log to terminal (this will show in the terminal where npm start is running)\r\n        logToTerminal('CUBE STATE AFTER SCRAMBLE (End of Scramble Session)', currentState);\r\n        \r\n        return currentState; // Return unchanged state\r\n      });\r\n      \r\n      return;\r\n    }\r\n    \r\n    const { move, direction } = sequence[0];\r\n    console.log(`Executing move: ${move} ${direction}`);\r\n    \r\n    // Apply the move using consolidated logic\r\n    setCubeState(prevState => {\r\n      const newState = [...prevState];\r\n      const pieces = newState.map((piece, index) => ({ ...piece, pieceId: index }));\r\n      \r\n      // Apply rotation using consolidated logic\r\n      applyRotation(pieces, move, direction);\r\n\r\n      // Update the newState with the modified pieces\r\n      pieces.forEach((piece, index) => {\r\n        newState[index] = {\r\n          position: piece.position,\r\n          colors: piece.colors,\r\n          rotationHistory: piece.rotationHistory\r\n        };\r\n      });\r\n      \r\n      return newState;\r\n    });\r\n    \r\n    // Continue with next move after a short delay\r\n    setTimeout(() => executeScramble(sequence.slice(1)), 100);\r\n  }, [applyRotation]);\r\n\r\n  // Scramble the cube\r\n  const scramble = useCallback(() => {\r\n    if (isAnimating) return;\r\n    \r\n    setIsAnimating(true);\r\n    \r\n    const moves = ['F', 'B', 'R', 'L', 'U', 'D'];\r\n    const directions = ['clockwise', 'counterclockwise'];\r\n    const scrambleSequence = [];\r\n    \r\n    // Generate 20 random moves\r\n    for (let i = 0; i < 20; i++) {\r\n      const move = moves[Math.floor(Math.random() * moves.length)];\r\n      const direction = directions[Math.floor(Math.random() * directions.length)];\r\n      scrambleSequence.push({ move, direction });\r\n    }\r\n    \r\n    console.log('Scrambling with sequence:', scrambleSequence);\r\n    \r\n    // Execute scramble moves\r\n    executeScramble(scrambleSequence);\r\n  }, [isAnimating, executeScramble]);\r\n\r\n  // Reset the cube to solved state\r\n  const reset = useCallback(() => {\r\n    setCubeState(() => {\r\n      const state = [];\r\n      \r\n      // Create 26 pieces (3x3x3 minus center)\r\n      for (let x = -1; x <= 1; x++) {\r\n        for (let y = -1; y <= 1; y++) {\r\n          for (let z = -1; z <= 1; z++) {\r\n            // Skip the center piece\r\n            if (x === 0 && y === 0 && z === 0) continue;\r\n            \r\n            // Determine piece type and assign colors accordingly\r\n            let colors = {\r\n              front: 'black',\r\n              back: 'black', \r\n              right: 'black',\r\n              left: 'black',\r\n              top: 'black',\r\n              bottom: 'black'\r\n            };\r\n            \r\n            // Assign colors based on piece position in solved state\r\n            // Only assign colors to faces that are visible (not internal)\r\n            if (x === -1) colors.left = 'orange';\r\n            if (x === 1) colors.right = 'red';\r\n            if (y === -1) colors.bottom = 'green';\r\n            if (y === 1) colors.top = 'blue';\r\n            if (z === -1) colors.back = 'yellow';\r\n            if (z === 1) colors.front = 'white';\r\n            \r\n            // Debug logging for reset state\r\n            console.log(`Reset piece at [${x}, ${y}, ${z}]:`, colors);\r\n            \r\n            state.push({ \r\n              position: [x, y, z], \r\n              colors,\r\n              rotationHistory: [] // Reset rotation history\r\n            });\r\n          }\r\n        }\r\n      }\r\n      \r\n      return state;\r\n    });\r\n  }, []);\r\n\r\n  return {\r\n    cubeState,\r\n    isAnimating,\r\n    rotateFace,\r\n    scramble,\r\n    reset\r\n  };\r\n}\r\n\r\n// Main cube group component with enhanced structure\r\nfunction CubeGroup({ isRotating, autoRotate = false, onScramble, onReset, onCubeStateChange }) {\r\n  const groupRef = useRef();\r\n  const [rotationSpeed] = useState({ x: 0.005, y: 0.01 });\r\n  \r\n  const { cubeState, isAnimating, rotateFace, scramble, reset } = useCubeState();\r\n  \r\n  // Helper functions for enhanced debugging\r\n  const getShapeType = (pieceId) => {\r\n    const shapeTypes = ['Square', 'Square', 'Square', 'Square', 'Square', 'Circle', 'Circle', 'Circle', 'Circle', 'Circle', 'Triangle', 'Triangle', 'Triangle', 'Triangle', 'Triangle', 'Diamond', 'Diamond', 'Diamond', 'Diamond', 'Diamond', 'Square+White', 'Square+White', 'Square+White', 'Square+White', 'Square+White', 'Square+White'];\r\n    return shapeTypes[pieceId] || 'Unknown';\r\n  };\r\n\r\n  const getShapeColor = (pieceId) => {\r\n    const shapeColors = ['Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Red', 'Blue', 'Green', 'Orange', 'Purple', 'Cyan'];\r\n    return shapeColors[pieceId] || 'Unknown';\r\n  };\r\n\r\n  const getExpectedPosition = (pieceId) => {\r\n    // Map pieceId to expected solved position\r\n    const positions = [];\r\n    for (let x = -1; x <= 1; x++) {\r\n      for (let y = -1; y <= 1; y++) {\r\n        for (let z = -1; z <= 1; z++) {\r\n          if (x === 0 && y === 0 && z === 0) continue;\r\n          positions.push([x, y, z]);\r\n        }\r\n      }\r\n    }\r\n    return positions[pieceId];\r\n  };\r\n\r\n  const getExpectedColorsForPosition = (position) => {\r\n    const [x, y, z] = position;\r\n    const expectedColors = {\r\n      front: 'black',\r\n      back: 'black',\r\n      right: 'black',\r\n      left: 'black',\r\n      top: 'black',\r\n      bottom: 'black'\r\n    };\r\n    \r\n    if (x === -1) expectedColors.left = 'orange';\r\n    if (x === 1) expectedColors.right = 'red';\r\n    if (y === -1) expectedColors.bottom = 'green';\r\n    if (y === 1) expectedColors.top = 'blue';\r\n    if (z === -1) expectedColors.back = 'yellow';\r\n    if (z === 1) expectedColors.front = 'white';\r\n    \r\n    return expectedColors;\r\n  };\r\n\r\n  const isPieceInCorrectPosition = (piece, pieceId) => {\r\n    // Check if piece is in its solved position\r\n    const [x, y, z] = piece.position;\r\n    const expectedPosition = getExpectedPosition(pieceId);\r\n    return x === expectedPosition[0] && y === expectedPosition[1] && z === expectedPosition[2];\r\n  };\r\n\r\n  const getColorMismatches = (piece) => {\r\n    // In a scrambled cube, there are no color mismatches based on position\r\n    // Colors should only be validated against the solved state, not current position\r\n    // This function is mainly for debugging and should not flag scrambled pieces as incorrect\r\n    return [];\r\n  };\r\n\r\n  const getVisibleFaces = (position) => {\r\n    const [x, y, z] = position;\r\n    const visibleFaces = [];\r\n    if (x === 1) visibleFaces.push('right');\r\n    if (x === -1) visibleFaces.push('left');\r\n    if (y === 1) visibleFaces.push('top');\r\n    if (y === -1) visibleFaces.push('bottom');\r\n    if (z === 1) visibleFaces.push('front');\r\n    if (z === -1) visibleFaces.push('back');\r\n    return visibleFaces;\r\n  };\r\n\r\n  const getVisibleColors = (piece) => {\r\n    const visibleFaces = getVisibleFaces(piece.position);\r\n    return visibleFaces.map(face => ({\r\n      face,\r\n      color: piece.colors[face]\r\n    }));\r\n  };\r\n\r\n  const isCubeSolved = (state) => {\r\n    return state.every((piece, index) => isPieceInCorrectPosition(piece, index));\r\n  };\r\n  \r\n  // Expose functions to parent\r\n  React.useEffect(() => {\r\n    if (onScramble) onScramble(scramble);\r\n    if (onReset) onReset(reset);\r\n  }, [onScramble, onReset, scramble, reset]);\r\n  \r\n  // Notify parent of cube state changes with enhanced debugging info\r\n  React.useEffect(() => {\r\n    if (onCubeStateChange && cubeState) {\r\n      console.log('ðŸ” Cube state changed, pieces count:', cubeState.length);\r\n      console.log('ðŸ” First few pieces:', cubeState.slice(0, 3));\r\n      \r\n      // Create enhanced cube state with debugging information\r\n      const enhancedCubeState = {\r\n        timestamp: new Date().toISOString(),\r\n        totalPieces: cubeState.length,\r\n        pieces: cubeState.map((piece, index) => ({\r\n          pieceId: index,\r\n          position: piece.position,\r\n          colors: piece.colors,\r\n          rotationHistory: piece.rotationHistory,\r\n          shapeType: getShapeType(index),\r\n          shapeColor: getShapeColor(index),\r\n          // Validation data\r\n          validation: {\r\n            isInCorrectPosition: isPieceInCorrectPosition(piece, index),\r\n            expectedColors: getExpectedColorsForPosition(piece.position),\r\n            colorMismatches: getColorMismatches(piece),\r\n            visibleFaces: getVisibleFaces(piece.position),\r\n            visibleColors: getVisibleColors(piece)\r\n          },\r\n          // Debugging helpers\r\n          debug: {\r\n            positionString: `[${piece.position.join(', ')}]`,\r\n            colorSummary: Object.entries(piece.colors)\r\n              .filter(([_, color]) => color !== 'black')\r\n              .map(([face, color]) => `${face}:${color}`)\r\n              .join(', '),\r\n            moveCount: piece.rotationHistory.length,\r\n            lastMove: piece.rotationHistory[piece.rotationHistory.length - 1] || null\r\n          }\r\n        })),\r\n        // Global validation\r\n        validation: {\r\n          isSolved: isCubeSolved(cubeState),\r\n          totalMoves: cubeState.reduce((sum, piece) => sum + piece.rotationHistory.length, 0),\r\n          piecesInCorrectPosition: cubeState.filter((piece, index) => \r\n            isPieceInCorrectPosition(piece, index)\r\n          ).length,\r\n          piecesWithColorMismatches: 0, // No color mismatches in scrambled state\r\n          isScrambled: !isCubeSolved(cubeState) && cubeState.some(piece => piece.rotationHistory.length > 0)\r\n        },\r\n        // Metadata\r\n        metadata: {\r\n          version: \"1.0.0\",\r\n          exportReason: \"debugging\",\r\n          cubeType: \"3x3x3\",\r\n          coordinateSystem: \"right-handed (X-right, Y-up, Z-front)\",\r\n          faceMapping: {\r\n            front: \"Z+ (white)\",\r\n            back: \"Z- (yellow)\", \r\n            right: \"X+ (red)\",\r\n            left: \"X- (orange)\",\r\n            top: \"Y+ (blue)\",\r\n            bottom: \"Y- (green)\"\r\n          },\r\n          shapeMapping: {\r\n            \"0-4\": \"Squares (Red, Blue, Green, Orange, Purple)\",\r\n            \"5-9\": \"Circles (Red, Blue, Green, Orange, Purple)\", \r\n            \"10-14\": \"Triangles (Red, Blue, Green, Orange, Purple)\",\r\n            \"15-19\": \"Diamonds (Red, Blue, Green, Orange, Purple)\",\r\n            \"20-25\": \"Squares+White (Red, Blue, Green, Orange, Purple, Cyan)\"\r\n          }\r\n        }\r\n      };\r\n      \r\n      onCubeStateChange(enhancedCubeState);\r\n    }\r\n  }, [onCubeStateChange, cubeState]);\r\n\r\n  // Auto-rotation animation\r\n  useFrame(() => {\r\n    if (groupRef.current && isRotating && !isAnimating) {\r\n      groupRef.current.rotation.x += rotationSpeed.x;\r\n      groupRef.current.rotation.y += rotationSpeed.y;\r\n    }\r\n  });\r\n\r\n  return (\r\n    <group ref={groupRef}>\r\n      {cubeState.map((piece, index) => (\r\n        <CubePiece\r\n          key={index}\r\n          position={piece.position}\r\n          colors={piece.colors}\r\n          pieceId={index}\r\n        />\r\n      ))}\r\n    </group>\r\n  );\r\n}\r\n\r\n// Main Rubik's Cube component\r\nfunction RubiksCube({ isRotating, autoRotate = false, onScramble, onReset, onCubeStateChange }) {\r\n  const groupRef = useRef();\r\n  const [rotationSpeed] = useState({ x: 0.005, y: 0.01 });\r\n  \r\n  const { cubeState, isAnimating, rotateFace, scramble, reset } = useCubeState();\r\n  \r\n  // Expose functions to parent\r\n  React.useEffect(() => {\r\n    if (onScramble) onScramble(scramble);\r\n    if (onReset) onReset(reset);\r\n  }, [onScramble, onReset, scramble, reset]);\r\n  \r\n  // Notify parent of cube state changes\r\n  React.useEffect(() => {\r\n    if (onCubeStateChange && cubeState) {\r\n      onCubeStateChange(cubeState);\r\n    }\r\n  }, [onCubeStateChange, cubeState]);\r\n\r\n  return (\r\n    <Canvas\r\n      camera={{ position: [5, 5, 5], fov: 50 }}\r\n      style={{ width: '100%', height: '100%' }}\r\n    >\r\n      {/* Enhanced lighting setup */}\r\n      <ambientLight intensity={1.2} />\r\n      <directionalLight position={[10, 10, 5]} intensity={3.0} />\r\n      <pointLight position={[10, 10, 10]} intensity={2.0} />\r\n      <pointLight position={[-10, -10, -10]} intensity={2.0} />\r\n      <spotLight\r\n        position={[0, 10, 0]}\r\n        angle={0.3}\r\n        penumbra={1}\r\n        intensity={2.0}\r\n        castShadow\r\n      />\r\n      \r\n      {/* Environment for better lighting */}\r\n      <Environment preset=\"sunset\" />\r\n      \r\n      <CubeGroup \r\n        isRotating={isRotating} \r\n        autoRotate={autoRotate}\r\n        onScramble={onScramble}\r\n        onReset={onReset}\r\n        onCubeStateChange={onCubeStateChange}\r\n      />\r\n      \r\n      <OrbitControls enablePan={true} enableZoom={true} enableRotate={true} />\r\n    </Canvas>\r\n  );\r\n}\r\n\r\nexport default RubiksCube;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}